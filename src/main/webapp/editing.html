<!DOCTYPE html>
<!--
 Copyright 2008 Google Inc. 
 Licensed under the Apache License, Version 2.0: 
 http://www.apache.org/licenses/LICENSE-2.0 
 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>AMRÂ  - Mappa parcheggi</title>
<link rel="stylesheet" type="text/css" href="css/style.css" />
<link rel="stylesheet" type="text/css"
	href="lib/jquery/css/redmond/jquery-ui-1.9.1.custom.min.css" />
<link rel="stylesheet" type="text/css"
	href="lib/jquery/css/jquery.colorpicker.css" />
<script
	src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=${gmap.key}"
	type="text/javascript"></script>
<script src="lib/jquery/jquery-1.8.2.js" type="text/javascript"></script>
<script src="lib/jquery/jquery-ui-1.9.1.custom.min.js"
	type="text/javascript"></script>
<script src="lib/jquery/jquery.colorpicker.js" type="text/javascript"></script>
<script src="lib/jquery/i18n/jquery.ui.colorpicker-it.js"></script>
<script src="lib/json2.js" type="text/javascript"></script>
<script src="lib/mapiconmaker.js" type="text/javascript"></script>

<script src="js/caller.js" type="text/javascript"></script>
<script src="js/renderer/area.js" type="text/javascript"></script>
<script src="js/renderer/parcometroLabels.js" type="text/javascript"></script>
<script src="js/renderer/parcometro.js" type="text/javascript"></script>
<script src="js/renderer/parcometroFilter.js" type="text/javascript"></script>
<script src="js/renderer/viaLabels.js" type="text/javascript"></script>
<script src="js/renderer/via.js" type="text/javascript"></script>
<script src="js/renderer/viaFilter.js" type="text/javascript"></script>
<script src="js/renderer/zona.js" type="text/javascript"></script>
<script src="js/renderer/puntobici.js" type="text/javascript"></script>
<script src="js/renderer/parcheggiostrutturaLabels.js"
	type="text/javascript"></script>
<script src="js/renderer/parcheggiostruttura.js" type="text/javascript"></script>
<script src="js/global.js" type="text/javascript"></script>

<script src="js/editor.js" type="text/javascript"></script>

<style type="text/css">
</style>
</head>

<script type="text/javascript">
	$(document).ready(function() {
		initializeMap();
		populate(true, [ 'area', 'via', 'parcometro', 'zona','parcheggiostruttura' ]);
	});
</script>


<body onunload="GUnload()">
	<ul id="menu">
		<li><a href="editing.html">Editor parcheggi</a></li>
		<li><a href="editing-bike.html">Editor puntobici</a></li>
	</ul>

	<div id="toolbar">
		<button id="crea-area" class="toolbar-action" onclick="createArea();">Crea
			area</button>
		<button id="crea-via" class="toolbar-action" onclick="createVia();">Crea
			via</button>
		<button id="crea-parcometro" class="toolbar-action"
			onclick="createParcometro();">Crea parcometro</button>
		<button id="crea-zona" class="toolbar-action" onclick="createZona();">Crea
			zona</button>
		<button id="crea-parcheggiostruttura" class="toolbar-action"
			onclick="createParcheggiostruttura();">Crea parcheggio in
			struttura</button>

	</div>
	<div id="map"></div>
	<div id="contents">
		<div class="element-list">
			<span class="title">Aree</span>
			<div class="toolbar-local-hidden"></div>
			<table id='area-info'>
			</table>
		</div>
		<div class="element-list">
			<span class="title">Parcometri</span>
			<div class="toolbar-local">
				<a href="#" onclick="loadParcometroFilter();">filtra</a>
			</div>
			<table id='parcometro-info'>
			</table>
		</div>
		<div class="element-list">
			<span class="title">Vie</span>
			<div class="toolbar-local">
				<a href="#" onclick="loadViaFilter();">filtra</a>
			</div>
			<table id='via-info'>
			</table>
		</div>
		<div class="element-list">
			<span class="title">Parcheggi in struttura</span>
			<div class="toolbar-local-hidden"></div>
			<table id='parcheggiostruttura-info'>
			</table>
		</div>
		<div class="element-list">
			<span class="title">Zone</span>
			<div class="toolbar-local-hidden"></div>
			<table id='zona-info'>
			</table>
		</div>

	</div>

	<!-- Crea Area form -->
	<div id="form-area">
		<form>
			<label for="area_nome">Nome</label> <label id="area_nome_msg"
				class="errorMsg"></label> <input type="text" name="area_nome"
				class="text ui-widget-content ui-corner-all" /> <label
				for="area_tariffa">Tariffa (euro/ora)</label> <label
				id="area_tariffa_msg" class="errorMsg"></label> <input type="text"
				name="area_tariffa" class="text ui-widget-content ui-corner-all" />

			<label for="area_fascia-oraria">Fascia oraria</label> <label
				id="area_fascia-oraria_msg" class="errorMsg"></label>
			<textarea name="area_fascia-oraria"
				class="note text ui-widget-content ui-corner-all">
					</textarea>
			<label for="area_codice-sms">Codice SMS</label> <label
				id="area_codice-sms_msg" class="errorMsg"></label> <input
				type="text" name="area_codice-sms"
				class="text ui-widget-content ui-corner-all" /> <label
				for="area_colore">Colore</label> <label id="area_colore_msg"
				class="errorMsg"></label> <input type="text" name="area_colore"
				class="text ui-widget-content ui-corner-all" /> <input
				type="hidden" name="area_id" />
		</form>
	</div>

	<!-- dialog color picker  -->
	<div id="color-picker-dialog">
		<input type="text" id="picker" />
	</div>

	<!-- filter dialogs -->
	<div id="parcometro-filter"></div>
	<div id="via-filter"></div>

	<div id="no-area">
		<p>Deve esistere almeno un'area prima della creazione di questo
			elemento</p>
	</div>

	<script>
		$(function() {

			$('#menu').menu();
			$('input[name="area_colore"]').colorpicker({
				alpha : false,
				rgb : false,
				hsv : false,
				parts : 'popup',
				color : $('input[name="zona_color"]').val(),
				modal : false,
				showNoneButton : false
			});

			$('#picker').colorpicker({
				alpha : false,
				rgb : false,
				hsv : false,
				parts : 'popup',
				modal : false,
				showNoneButton : false,
				close : function(event, color) {
					dialogPicker.dialog("close");
				},
				select : function(event, color) {
					$('input[name="zona_color"]').val(color.formatted);
				}
			});

			// 	***********************  dialogs

			$("#color-picker-dialog").dialog({
				autoOpen : false,
				minWidth : 500,
				modal : true,
				resizable : false,
				buttons : {},
				open : function() {
					map.disableScrollWheelZoom();
				},
				close : function() {
					map.enableScrollWheelZoom();
				}
			});

			$("#form-area").dialog({
				autoOpen : false,
				width : 350,
				modal : true,
				resizable : false,
				buttons : {
					"Annulla" : function() {
						$(this).dialog("close");
					},
					"Salva" : function() {
						saveArea();
					}
				},
				open : function() {
					map.disableScrollWheelZoom();
				},
				close : function() {
					map.enableScrollWheelZoom();
					resetToolbar();
					resetAreaMsgs();
					resetAreaForm();
				}
			});

			$("#parcometro-filter").dialog({
				autoOpen : false,
				height : 400,
				width : 350,
				modal : true,
				resizable : false,
				buttons : {
					"Annulla" : function() {
						removeFilterParcometro();
						$(this).dialog("close");
					},
					"Filtra" : function() {
						filterParcometro();
						$(this).dialog("close");
					}
				},
				open : function() {
					map.disableScrollWheelZoom();
				},
				close : function() {
					map.enableScrollWheelZoom();
				}
			});

			$("#via-filter").dialog({
				autoOpen : false,
				height : 400,
				width : 350,
				modal : true,
				resizable : false,
				buttons : {
					"Annulla" : function() {
						removeFilterVia();
						$(this).dialog("close");
					},
					"Filtra" : function() {
						filterVia();
						$(this).dialog("close");
					}
				},
				open : function() {
					map.disableScrollWheelZoom();
				},
				close : function() {
					map.enableScrollWheelZoom();
				}
			});

			$("#no-area").dialog({
				autoOpen : false,
				modal : true,
				resizable : false,
				buttons : {
					Ok : function() {
						$(this).dialog("close");
					},
					open : function() {
						map.disableScrollWheelZoom();
					},
					close : function() {
						map.enableScrollWheelZoom();
					}
				}
			});
		});
	</script>
</body>
</html>
